<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>R-View</title>
    <link rel="shortcut icon" href="../images/pincel.png">
    <link rel="stylesheet" href="./Main.css" />
    <link rel="stylesheet" href="./responsividade.css">
    <link
      rel="stylesheet"
      href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css"
      integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh"
      crossorigin="anonymous"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/prettify/r298/prettify.min.css"
    />
  </head>
  <body>
    <div class="Container-superior">
      <div class="Header">
        <div class="Header-image">
          <img src="./R_VIEW.png" alt="" width="150px" height="auto" />
        </div>
      </div>

      <div class="Container-box">
        <!-- menu lateral -->
        <div class="container-lateral">
          <div class="container-user-import">
            <div class="container-import" onclick="{importfile(event)}">
                <img src="../images/importar.png" alt="icon import navbar" class="imagemImport"/>
                <input type="file" name="importFile" id="importFile" accept=".pdf" class="importFile">
              <a class="help-button col-sm-4 downloadupaddinvoice"  title="Download uploaded invoice" download><i class="icon-download-alt"></i></a>
            </div>

            <div class="container-user2">
              <div class="container-mouse2" onclick="{enableSelector(event)}">
                <img src="../images/mao.png" alt="icon mao navbar" />
              </div>
              <div
                class="container-lixeira2"
                onclick="{deleteSelectedObject(event)}"
              >
                <img src="../images/lixo.png" alt="icon lixo navbar" />
              </div>
              <div class="container-save2" onclick="{savePDF()}">
                <img src="../images/disquete.png" alt="icon save navbar" />
              </div>
            </div>
          </div>

          <div class="container-icons">
            <div class="container-icons__primeiro" onclick="{addImage(event)}">
              <img src="../images/galeria.png" alt="icon house navbar" />
            </div>

            <div class="container-icons__segundo" onclick="{clearPage(event)}">
              <img
                src="../images/excluir-selecao.png"
                alt="icon user navbar"
              />
            </div>

            <div
              class="container-icons__terceiro"
              id="buttonPincel"
              onclick="{enablePencil(event)}"
            >
              <img src="../images/pincel.png" alt="icon galeria navbar" />
            </div>

            <div
              class="container-icons__quarto container-A"
              id="buttonA"
              onclick="{enableAddText(event)}"
            >
              <img src="../images/a.png" alt="icon Alfabeto navbar" />
            </div>

            <div class="container-icons__quinto" id="buttonStar">
              <img src="../images/Star.png" alt="icon Estrela navbar" />
            </div>
          </div>

          <div class="container-user">
            <div class="container-mouse" onclick="{enableSelector(event)}">
              <img src="../images/mao.png" alt="icon mao navbar" />
            </div>
            <div
              class="container-lixeira"
              onclick="{deleteSelectedObject(event)}"
            >
              <img src="../images/lixo.png" alt="icon lixo navbar" />
            </div>
            <div class="container-save" onclick="{savePDF()}">
              <img src="../images/disquete.png" alt="icon save navbar" />
            </div>
          </div>
        </div>

        <div class="separador">
          <div class="option"></div>
        </div>

        <!--container buttons do pincel-->
        <div class="container-buttons-pincel">
          <div class="container-buttons__pincel">
            <div
              class="button-secundario color-tool"
              style="background-color: #212121"
            ></div>

            <div
              class="button-secundario color-tool"
              style="background-color: red"
            ></div>

            <div
              class="button-secundario color-tool"
              style="background-color: blue"
            ></div>

            <div
              class="button-secundario color-tool"
              style="background-color: green"
            ></div>

            <div
              class="button-secundario color-tool"
              style="background-color: yellow"
            ></div>
          </div>
        </div>

        <!--container buttons do A-->
        <div class="container-buttons-A">
          <div class="container-buttons__A">
            <div class="button-secundario-A">
              <label for>Brush</label>
              <label for>Size</label>
              <input
                type="number"
                class="form-control text-right"
                value="1"
                id="brush-size"
                max="50"
              />
            </div>

            <div class="button-secundario-A">
              <label for>Font</label>
              <label for>Size</label>
              <select id="font-size" class="form-control">
                <option value="10">10</option>
                <option value="12">12</option>
                <option value="16" selected="">16</option>
                <option value="18">18</option>
                <option value="24">24</option>
                <option value="32">32</option>
                <option value="48">48</option>
                <option value="64">64</option>
                <option value="72">72</option>
                <option value="108">108</option>
              </select>
            </div>
          </div>
        </div>

        <!--container buttons do Star-->
        <div class="container-buttons-Star">
          <div class="container-buttons__Star">
            <div class="button-secundario">
              <img
                src="../images/circulo.png"
                onclick="enableCircle(event)"
                alt=""
              />
            </div>

            <div class="button-secundario" onclick="enableRectangle(event)">
              <img src="../images/quadrado.png" alt="" />
            </div>

            <div class="button-secundario">
              <img
                src="../images/triangulo.png"
                onclick="enableTriangulo(event)"
                alt=""
              />
            </div>

            <div class="button-secundario">
              <img
                src="../images/linha.png"
                onclick="enableLine(event)"
                alt=""
              />
            </div>

            <div
              class="button-secundario B5-STAR"
              onclick="enableQuadrado(event)   "
            >
              <img src="../images/retangulo.png" alt="" />
            </div>
          </div>
        </div>

        <!-- container central -->
        <div id="pdf-container" class="pdf-container"></div>
      </div>

      <div class="container-bottom"></div>
    </div>

    <script src="scriptButton.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script
      src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"
      integrity="sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"
      integrity="sha384-B4gt1jrGC7Jh4AgTPSdUtOBvfO8shuf57BaghqFfPlYxofvL8/KUEfYiJOMMV+rV"
      crossorigin="anonymous"
    ></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.6.347/pdf.min.js"></script>
    <script>
      pdfjsLib.GlobalWorkerOptions.workerSrc =
        "https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.6.347/pdf.worker.min.js";
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fabric.js/4.3.0/fabric.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.2.0/jspdf.umd.min.js"></script>
    <script src="https://cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prettify/r298/prettify.min.js"></script>
    <script type="module" src="https://unpkg.com/axios/dist/axios.min.js" ></script>

    <script>
      // Extended fabric line class
      fabric.LineArrow = fabric.util.createClass(fabric.Line, {
        type: "lineArrow",

        initialize: function (element, options) {
          options || (options = {});
          this.callSuper("initialize", element, options);
        },

        toObject: function () {
          return fabric.util.object.extend(this.callSuper("toObject"));
        },

        _render: function (ctx) {
          this.callSuper("_render", ctx);

          // do not render if width/height are zeros or object is not visible
          if (this.width === 0 || this.height === 0 || !this.visible) return;

          ctx.save();

          var xDiff = this.x2 - this.x1;
          var yDiff = this.y2 - this.y1;
          var angle = Math.atan2(yDiff, xDiff);
          ctx.translate((this.x2 - this.x1) / 2, (this.y2 - this.y1) / 2);
          ctx.rotate(angle);
          ctx.beginPath();
          //move 10px in front of line to start the arrow so it does not have the square line end showing in front (0,0)
          ctx.moveTo(10, 0);
          ctx.lineTo(-20, 15);
          ctx.lineTo(-20, -15);
          ctx.closePath();
          ctx.fillStyle = this.stroke;
          ctx.fill();

          ctx.restore();
        },
      });

      fabric.LineArrow.fromObject = function (object, callback) {
        callback &&
          callback(
            new fabric.LineArrow(
              [object.x1, object.y1, object.x2, object.y2],
              object
            )
          );
      };

      fabric.LineArrow.async = true;

      var Arrow = (function () {
        function Arrow(canvas, color, callback) {
          this.canvas = canvas;
          this.className = "Arrow";
          this.isDrawing = false;
          this.color = color;
          this.callback = callback;
          this.bindEvents();
        }

        Arrow.prototype.bindEvents = function () {
          var inst = this;
          inst.canvas.on("mouse:down", function (o) {
            inst.onMouseDown(o);
          });
          inst.canvas.on("mouse:move", function (o) {
            inst.onMouseMove(o);
          });
          inst.canvas.on("mouse:up", function (o) {
            inst.onMouseUp(o);
          });
          inst.canvas.on("object:moving", function (o) {
            inst.disable();
          });
        };

        Arrow.prototype.unBindEventes = function () {
          var inst = this;
          inst.canvas.off("mouse:down");
          inst.canvas.off("mouse:up");
          inst.canvas.off("mouse:move");
          inst.canvas.off("object:moving");
        };

        Arrow.prototype.onMouseUp = function (o) {
          var inst = this;
          inst.disable();
          inst.unBindEventes();
          if (inst.callback) inst.callback();
        };

        Arrow.prototype.onMouseMove = function (o) {
          var inst = this;
          if (!inst.isEnable()) {
            return;
          }

          var pointer = inst.canvas.getPointer(o.e);
          var activeObj = inst.canvas.getActiveObject();
          activeObj.set({
            x2: pointer.x,
            y2: pointer.y,
          });
          activeObj.setCoords();
          inst.canvas.renderAll();
        };

        Arrow.prototype.onMouseDown = function (o) {
          var inst = this;
          inst.enable();
          var pointer = inst.canvas.getPointer(o.e);

          var points = [pointer.x, pointer.y, pointer.x, pointer.y];
          var line = new fabric.LineArrow(points, {
            strokeWidth: 5,
            fill: inst.color ? inst.color : "red",
            stroke: inst.color ? inst.color : "red",
            originX: "center",
            originY: "center",
            hasBorders: false,
            hasControls: true,
            selectable: true,
          });

          inst.canvas.add(line).setActiveObject(line);
        };

        Arrow.prototype.isEnable = function () {
          return this.isDrawing;
        };

        Arrow.prototype.enable = function () {
          this.isDrawing = true;
        };

        Arrow.prototype.disable = function () {
          this.isDrawing = false;
        };

        return Arrow;
      })();
    </script>
    <script>
      var PDFAnnotate = function (container_id, url, options = {}) {
        this.number_of_pages = 0;
        this.pages_rendered = 0;
        this.active_tool = 1;
        this.fabricObjects = [];
        this.fabricObjectsData = [];
        this.color = "#212121";
        this.borderColor = "#000000";
        this.borderSize = 1;
        this.font_size = 16;
        this.active_canvas = 0;
        this.container_id = container_id;
        this.url = url;
        this.pageImageCompression = options.pageImageCompression
          ? options.pageImageCompression.toUpperCase()
          : "NONE";
        var inst = this;

        var loadingTask = pdfjsLib.getDocument(this.url);
        loadingTask.promise.then(
          function (pdf) {
            var scale = options.scale ? options.scale : 1.3;
            inst.number_of_pages = pdf.numPages;

            for (var i = 1; i <= pdf.numPages; i++) {
              pdf.getPage(i).then(function (page) {
                var viewport = page.getViewport({
                  scale: scale,
                });
                var canvas = document.createElement("canvas");
                document.getElementById(inst.container_id).appendChild(canvas);
                canvas.className = "pdf-canvas";
                canvas.height = viewport.height;
                canvas.width = viewport.width;
                context = canvas.getContext("2d");

                var renderContext = {
                  canvasContext: context,
                  viewport: viewport,
                };
                var renderTask = page.render(renderContext);
                renderTask.promise.then(function () {
                  $(".pdf-canvas").each(function (index, el) {
                    $(el).attr("id", "page-" + (index + 1) + "-canvas");
                  });
                  inst.pages_rendered++;
                  if (inst.pages_rendered == inst.number_of_pages)
                    inst.initFabric();
                });
              });
            }
          },
          function (reason) {
            console.error(reason);
          }
        );

        this.initFabric = function () {
          var inst = this;
          let canvases = $("#" + inst.container_id + " canvas");
          canvases.each(function (index, el) {
            var background = el.toDataURL("image/png");
            var fabricObj = new fabric.Canvas(el.id, {
              freeDrawingBrush: {
                width: 1,
                color: inst.color,
              },
            });
            inst.fabricObjects.push(fabricObj);
            if (typeof options.onPageUpdated == "function") {
              fabricObj.on("object:added", function () {
                var oldValue = Object.assign({}, inst.fabricObjectsData[index]);
                inst.fabricObjectsData[index] = fabricObj.toJSON();
                options.onPageUpdated(
                  index + 1,
                  oldValue,
                  inst.fabricObjectsData[index]
                );
              });
            }
            fabricObj.setBackgroundImage(
              background,
              fabricObj.renderAll.bind(fabricObj)
            );
            $(fabricObj.upperCanvasEl).click(function (event) {
              inst.active_canvas = index;
              inst.fabricClickHandler(event, fabricObj);
            });
            fabricObj.on("after:render", function () {
              inst.fabricObjectsData[index] = fabricObj.toJSON();
              fabricObj.off("after:render");
            });

            if (
              index === canvases.length - 1 &&
              typeof options.ready === "function"
            ) {
              options.ready();
            }
          });
        };

        this.fabricClickHandler = function (event, fabricObj) {
          var inst = this;
          if (inst.active_tool == 2) {
            var text = new fabric.IText("Sample text", {
              left:
                event.clientX -
                fabricObj.upperCanvasEl.getBoundingClientRect().left,
              top:
                event.clientY -
                fabricObj.upperCanvasEl.getBoundingClientRect().top,
              fill: inst.color,
              fontSize: inst.font_size,
              selectable: true,
            });
            fabricObj.add(text);
            inst.active_tool = 0;
          }
        };
      };

      PDFAnnotate.prototype.enableSelector = function () {
        var inst = this;
        inst.active_tool = 0;
        if (inst.fabricObjects.length > 0) {
          $.each(inst.fabricObjects, function (index, fabricObj) {
            fabricObj.isDrawingMode = false;
          });
        }
      };

      PDFAnnotate.prototype.enablePencil = function () {
        var inst = this;
        inst.active_tool = 1;
        if (inst.fabricObjects.length > 0) {
          $.each(inst.fabricObjects, function (index, fabricObj) {
            fabricObj.isDrawingMode = true;
          });
        }
      };

      PDFAnnotate.prototype.enableAddText = function () {
        var inst = this;
        inst.active_tool = 2;
        if (inst.fabricObjects.length > 0) {
          $.each(inst.fabricObjects, function (index, fabricObj) {
            fabricObj.isDrawingMode = false;
          });
        }
      };

      PDFAnnotate.prototype.enableRectangle = function () {
        var inst = this;
        var fabricObj = inst.fabricObjects[inst.active_canvas];
        inst.active_tool = 4;
        if (inst.fabricObjects.length > 0) {
          $.each(inst.fabricObjects, function (index, fabricObj) {
            fabricObj.isDrawingMode = false;
          });
        }

        var rect = new fabric.Rect({
          width: 100,
          height: 100,
          fill: "transparent",
          stroke: inst.color,
          strokeSize: inst.borderSize,
        });
        fabricObj.add(rect);
      };

      PDFAnnotate.prototype.enableCircle = function () {
        var inst = this;
        var fabricObj = inst.fabricObjects[inst.active_canvas];
        inst.active_tool = 1;
        if (inst.fabricObjects.length > 0) {
          $.each(inst.fabricObjects, function (index, fabricObj) {
            fabricObj.isDrawingMode = false;
          });
        }

        var circle = new fabric.Circle({
          radius: 40,
          fill: "transparent",
          left: 100,
          top: 100,
          stroke: inst.color,
          strokeSize: 1,
        });

        fabricObj.add(circle);
      };

      PDFAnnotate.prototype.enableTriangulo = function () {
        var inst = this;
        var fabricObj = inst.fabricObjects[inst.active_canvas];
        inst.active_tool = 1;
        if (inst.fabricObjects.length > 0) {
          $.each(inst.fabricObjects, function (index, fabricObj) {
            fabricObj.isDrawingMode = false;
          });
        }

        var triangle = new fabric.Triangle({
          width: 70,
          height: 80,
          fill: "transparent",
          left: 50,
          top: 50,
          stroke: inst.color,
        });

        fabricObj.add(triangle);
      };

      PDFAnnotate.prototype.enableLine = function () {
        var inst = this;
        var fabricObj = inst.fabricObjects[inst.active_canvas];
        inst.active_tool = 1;
        if (inst.fabricObjects.length > 0) {
          $.each(inst.fabricObjects, function (index, fabricObj) {
            fabricObj.isDrawingMode = false;
          });
        }

        //, top , left ,bottom
        var line = new fabric.Line([300, 50, 200, 150], {
          width: 50,
          height: 50,
          background: inst.color,
          fill: inst.color,
          stroke: inst.color,
        });

        fabricObj.add(line);
      };

      PDFAnnotate.prototype.enableQuadrado = function () {
        var inst = this;
        var fabricObj = inst.fabricObjects[inst.active_canvas];
        inst.active_tool = 1;
        if (inst.fabricObjects.length > 0) {
          $.each(inst.fabricObjects, function (index, fabricObj) {
            fabricObj.isDrawingMode = false;
          });
        }

        //, top , left ,bottom
        var quadrado = new fabric.Rect({
          width: 200,
          height: 100,
          fill: "transparent",
          stroke: inst.color,
        });

        fabricObj.add(quadrado);
      };

      PDFAnnotate.prototype.enableAddArrow = function () {
        var inst = this;
        inst.active_tool = 3;
        if (inst.fabricObjects.length > 0) {
          $.each(inst.fabricObjects, function (index, fabricObj) {
            fabricObj.isDrawingMode = false;
            new Arrow(fabricObj, inst.color, function () {
              inst.active_tool = 0;
            });
          });
        }
      };

      PDFAnnotate.prototype.addImageToCanvas = function () {
        var inst = this;
        var fabricObj = inst.fabricObjects[inst.active_canvas];

        if (fabricObj) {
          var inputElement = document.createElement("input");
          inputElement.type = "file";
          inputElement.className = "inputFoto";
          inputElement.accept = ".jpg,.jpeg,.png,.PNG,.JPG,.JPEG";
          inputElement.onchange = function () {
            var reader = new FileReader();
            reader.addEventListener(
              "load",
              function () {
                inputElement.remove();
                var image = new Image();
                image.onload = function () {
                  fabricObj.add(new fabric.Image(image));
                };
                image.src = this.result;
              },
              false
            );
            reader.readAsDataURL(inputElement.files[0]);
          };
          document.getElementsByTagName("body")[0].appendChild(inputElement);
          inputElement.click();
        }
      };

      PDFAnnotate.prototype.deleteSelectedObject = function () {
        var inst = this;
        var activeObject =
          inst.fabricObjects[inst.active_canvas].getActiveObject();
        if (activeObject) {
          if (confirm("Você tem certeza ?"))
            inst.fabricObjects[inst.active_canvas].remove(activeObject);
        }
      };

      PDFAnnotate.prototype.savePdf = function (fileName) {
        var inst = this;
        var doc = new jspdf.jsPDF();
        if (typeof fileName === "undefined") {
          fileName = `${new Date().getTime()}.pdf`;
        }

        inst.fabricObjects.forEach(function (fabricObj, index) {
          if (index != 0) {
            doc.addPage();
            doc.setPage(index + 1);
          }
          doc.addImage(
            fabricObj.toDataURL({
              format: "png",
            }),
            inst.pageImageCompression == "NONE" ? "PNG" : "JPEG",
            0,
            0,
            doc.internal.pageSize.getWidth(),
            doc.internal.pageSize.getHeight(),
            `page-${index + 1}`,
            ["FAST", "MEDIUM", "SLOW"].indexOf(inst.pageImageCompression) >= 0
              ? inst.pageImageCompression
              : undefined
          );
          if (index === inst.fabricObjects.length - 1) {
            doc.save(fileName);
          }
        });
      };

      PDFAnnotate.prototype.setBrushSize = function (size) {
        var inst = this;
        $.each(inst.fabricObjects, function (index, fabricObj) {
          fabricObj.freeDrawingBrush.width = size;
        });
      };

      PDFAnnotate.prototype.setColor = function (color) {
        var inst = this;
        inst.color = color;
        $.each(inst.fabricObjects, function (index, fabricObj) {
          fabricObj.freeDrawingBrush.color = color;
        });
      };

      var getBordeColor;

      PDFAnnotate.prototype.setBorderColor = function (color) {
        var inst = this;
        inst.borderColor = color;

        getBordeColor = color;
      };

      PDFAnnotate.prototype.setFontSize = function (size) {
        this.font_size = size;
      };

      PDFAnnotate.prototype.setBorderSize = function (size) {
        this.borderSize = size;
      };

      PDFAnnotate.prototype.clearActivePage = function () {
        var inst = this;
        var fabricObj = inst.fabricObjects[inst.active_canvas];
        var bg = fabricObj.backgroundImage;
        if (confirm("Você quer apagar tudo?")) {
          fabricObj.clear();
          fabricObj.setBackgroundImage(bg, fabricObj.renderAll.bind(fabricObj));
        }
      };

      PDFAnnotate.prototype.serializePdf = function () {
        var inst = this;
        return JSON.stringify(inst.fabricObjects, null, 4);
      };

      PDFAnnotate.prototype.loadFromJSON = function (jsonData) {
        var inst = this;
        $.each(inst.fabricObjects, function (index, fabricObj) {
          if (jsonData.length > index) {
            fabricObj.loadFromJSON(jsonData[index], function () {
              inst.fabricObjectsData[index] = fabricObj.toJSON();
            });
          }
        });
      };
    </script>
    <script>
      //var url = "https://training.github.com/downloads/pt_BR/github-git-cheat-sheet.pdf";  

      function changeActiveTool(event) {
        var element = $(event.target).hasClass("tool-button")
          ? $(event.target)
          : $(event.target).parents(".tool-button").first();
        $(".tool-button.active").removeClass("active");
        $(element).addClass("active");
      }

      var pdf;

      function importfile(){


          if(pdf != undefined){
            //console.log(pdf);
            window.location.reload();
            pdf = "";
            blob = "";
          }

          document.querySelector("#importFile").addEventListener("change", () => {
            let pdfFile = document.querySelector("#importFile").files[0]


            let blob = URL.createObjectURL(pdfFile);
             console.log(blob);
             console.log(typeof blob);

             pdf = new PDFAnnotate("pdf-container", blob,  {
              onPageUpdated(page, oldData, newData) {
                console.log(page, oldData, newData);
              },
              ready() {
                console.log("Plugin initialized successfully");
              },
              scale: 1.5,
              pageImageCompression: "SLOW", // FAST, MEDIUM, SLOW(Helps to control the new PDF file size)
             });
          });
      }

      /*$(".downloadupaddinvoice").click(function(){
        var filename = $('.importFile').val();

        if (filename == "" || filename == null) {
            alert('Error');
        }else {
            var file = document.getElementById('importFile').files[0];      
            var filename = document.getElementById('importFile').files[0].name;      
            var blob = new Blob([file]);
            var url  = URL.createObjectURL(blob);

            console.log(file);
            console.log(filename);
            console.log(blob);
            console.log(url);

            $(this).attr({ 'download': filename, 'href': url});  
            filename = "";
        }

      })*/
      

      function enableSelector(event) {
        event.preventDefault();
        changeActiveTool(event);
        pdf.enableSelector();
      }

      function enablePencil(event) {
        event.preventDefault();
        changeActiveTool(event);
        pdf.enablePencil();
      }

      function enableAddText(event) {
        event.preventDefault();
        changeActiveTool(event);
        pdf.enableAddText();
      }

      function enableAddArrow(event) {
        event.preventDefault();
        changeActiveTool(event);
        pdf.enableAddArrow();
      }

      function addImage(event) {
        event.preventDefault();
        pdf.addImageToCanvas();
      }

      function enableCircle(event) {
        event.preventDefault();
        changeActiveTool(event);
        pdf.enableCircle();
      }

      function enableTriangulo(event) {
        event.preventDefault();
        changeActiveTool(event);
        pdf.enableTriangulo();
      }

      function enableLine(event) {
        event.preventDefault();
        changeActiveTool(event);
        pdf.enableLine();
      }

      function enableQuadrado(event) {
        event.preventDefault();
        changeActiveTool(event);
        pdf.enableQuadrado();
      }

      function enableRectangle(event) {
        event.preventDefault();
        changeActiveTool(event);
        pdf.enableRectangle();
      }

      function deleteSelectedObject(event) {
        event.preventDefault();
        pdf.deleteSelectedObject();
      }

      function savePDF() {
        // pdf.savePdf();
        pdf.savePdf("sample.pdf"); // save with given file name
      }

      function clearPage() {
        pdf.clearActivePage();
      }

      function showPdfData() {
        var string = pdf.serializePdf();
        $("#dataModal .modal-body pre").first().text(string);
        PR.prettyPrint();
        $("#dataModal").modal("show");
      }

      $(function () {
        $(".color-tool").click(function () {
          $(".color-tool.active").removeClass("active");
          $(this).addClass("active");
          color = $(this).get(0).style.backgroundColor;
          pdf.setColor(color);
        });

        $("#brush-size").change(function () {
          var width = $(this).val();
          pdf.setBrushSize(width);
        });

        $("#font-size").change(function () {
          var font_size = $(this).val();
          pdf.setFontSize(font_size);
        });
      });
    </script>
  </body>
</html>